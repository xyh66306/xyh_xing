<div class="panel panel-default panel-intro">

    <div class="panel-heading" style="background-color: #fff;">
        <div class="row">
            <div class="col-sm-6">
                <div class="item_header">可用金额</div>
                <div class="item_value">{$supply_info.usdt }</div>
            </div>
            <div class="col-sm-6">
                <div class="item_header">冻结金额</div>
                <div class="item_value">{$supply_info.freeze_usdt }</div>
            </div>
        </div>
    </div>

    <div class="panel-body">

        <!-- 第一步：转账信息 -->
        <div id="step1" class="active-step step-content">
            <div class="item">
                <label class="block" for="type">类型</label>
                <select id="type" name="type" class="form-control">
                    <option value="">请选择通道类型</option>
                    <option value="USDT-TRC20">USDT-TRC20</option>
                </select>
            </div>
            <div class="item">
                <label class="block" for="usdt">可提币数量：</label>
                <div class="relative">
                    <input type="number" id="account" value="{$supply_info['usdt']}" class="form-control" readonly>
                </div>
            </div>
            <div class="item">
                <label class="block" for="usdt">提币数量</label>
                <div class="relative">
                    <input type="number" id="usdt" class="form-control" placeholder="0.00" step="0.01" min="0">
                </div>
            </div>
            <div class="item">
                <label class="block" for="usdt">手续费：</label>
                <div class="relative">
                    <input type="number" id="fee" class="form-control" readonly>
                </div>
            </div>

            <div class="item">
                <label class="block" for="hash">哈希值</label>
                <div class="relative">
                    <input type="text" id="hash" class="form-control">
                </div>
            </div>
            <button type="button" onclick="submitTransfer(2)" class="w-full nextbtn">确认提交</button>
        </div>

    </div>
</div>


<script>
    let currentStep = 1;
    const transferData = {};

    function uploadImg() {
        require(['upload'], function (Upload) {
            Upload.api.plupload($(".faupload"), function (data, ret) {
                let url = data.fullurl;
                $("#c-pay_ewm_image").val(url);
                transferData.pay_ewm_image = url;
            });
        });
    }

    var usdt = document.getElementById('usdt');
    var fee_rate = 0.01;
    usdt.addEventListener('blur', function () {
        var fee = (parseFloat(usdt.value) * parseFloat(fee_rate)).toFixed(4)
        document.getElementById('fee').value = fee;
    });


    function submitTransfer() {

        const type = document.getElementById('type').value;
        const usdt = document.getElementById('usdt').value;
        const hash = document.getElementById('hash').value;
        const fee = document.getElementById('fee').value;

        console.log(fee);

        if (!type) {
            alert('请选择通道类型');
            return;
        }
        if (!usdt || parseFloat(usdt) <= 0) {
            alert('请输入有效的提币金额');
            return;
        }
        if (!hash) {
            alert('请输入哈希值');
            return;
        }
        if (!fee) {
            alert('请输入手续费');
            return;
        }

        transferData.type = type;
        transferData.usdt = usdt;
        transferData.hash = hash;
        transferData.fee = fee;

        // 提交转账申请
        Fast.api.ajax({
            url: 'supply/usdt/txadd',
            dataType: 'json',
            data: transferData,
            cache: false
        }, function (ret) {
            if (ret.code == 1) {
                Toastr.success(ret.msg);
            } else {
                Toastr.error(ret.msg);
            }
        }, function (ret) {
            Toastr.error(ret.msg);
        });
    }
</script>


<style>
    .item_header {
        margin-bottom: 4px;
        color: rgba(0, 0, 0, .45);
        font-size: 14px;
    }

    .item_value {
        color: rgba(0, 0, 0, .85);
        font-size: 24px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    }

    .step-content {
        display: none;
    }

    .active-step {
        display: block;
    }

    .steps {
        display: flex;
    }

    .step {
        display: flex;
        flex: 1 1;
        align-items: center;
        position: relative;
        z-index: 999;
        background-color: #fff;
    }

    .step .box {
        display: flex;
        flex: 1 1;
        align-items: center;
        position: relative;
        z-index: 999;
        background-color: #fff;
    }

    .step-icon {
        width: 32px;
        height: 32px;
        background: #fff;
        border-radius: 50%;
        overflow: hidden;
        color: #666;
        font-size: 16px;
        text-align: center;
        line-height: 200%;
        border: rgba(0, 0, 0, .25) 1px solid;
    }

    .active-step .step-icon {
        width: 32px;
        height: 32px;
        background: #1890ff;
        border-radius: 50%;
        overflow: hidden;
        color: #fff;
        font-size: 16px;
        text-align: center;
        line-height: 200%;
    }

    .step-label {
        margin-left: 10px;
        color: rgba(0, 0, 0, .85);
        position: relative;
    }

    .step-label::after {
        position: absolute;
        z-index: 1;
        top: 10px;
        right: -110px;
        display: block;
        width: 99px;
        height: 1px;
        background: #f0f0f0;
        content: "";
    }

    .step_end .step-label::after {
        display: none;
    }

    .step-content {
        display: none;
        width: 500px;
        margin: 40px auto 0;
    }

    .step-content.active-step {
        display: block;
    }

    .item {
        display: flex;
        align-items: center;
        padding: 5px 0;
    }

    .item label {
        flex: 0 0 100px;
        height: 35px;
        line-height: 35px;
    }

    .item label {
        flex: 0 0 100px;
        height: 35px;
        line-height: 35px;
    }

    .w-full {
        width: 300px;
        height: 35px;
        line-height: 35px;
    }

    #remark {
        width: 300px;
        min-height: 60px;
    }

    .nextbtn {
        width: 80%;
        height: 42px;
        background: #1890ff;
        border: none;
        color: #fff;
        line-height: 42px;
        border-radius: 4px;
        overflow: hidden;
        cursor: pointer;
        margin-top: 30px;
    }

    .bg-gray-200 {
        background-color: #f0f0f0;
        width: 200px;
        height: 40px;
        line-height: 40px;
        border-radius: 4px;
        border: none;
    }

    .bg-blue-500 {
        background-color: #1890ff;
        width: 200px;
        height: 40px;
        line-height: 40px;
        color: #fff;
        border-radius: 4px;
        border: none;

    }

    .space-x-4 {
        margin-top: 30px;
    }

    .paybox {
        display: none;
        overflow: hidden;
    }
</style>